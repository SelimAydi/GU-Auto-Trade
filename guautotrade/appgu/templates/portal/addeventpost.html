{% extends "frames/base_portal.html" %}
{% load static %}

{% block header %}
	{% with headerclass='portal' %}
			{{ block.super }}
	{% endwith%}
{% endblock header%}


{% block content %}
<!-- Home -->
<div id="home" class="hero-area">

			<!-- Backgound -->
			<div style="background-color: white;"></div>
			<!-- /Backgound -->

			<div class="home-wrapper" style="-webkit-transform: initial; position: relative; top: initial;">

				<div class="container">
					<div class="row">
					<div class="section-intro text-center">
						{% if user.is_authenticated %}
                            {% if user.is_staff %}
							<h2>Add Event</h2>
							<p class="lead">Here you can add events to the database, to be displayed on the events calendar.</p>
							<div class="row">
								  <form action="/portal/addeventpost/" method="post" id="eventform" class="registerform">
                                    {% csrf_token %}
                                      {{ form.as_p }}
                                      <button id="uploadbutton"  class="main-button icon-button form-button" type="submit">Add Event</button>
                                  </form>
                            <div id="suc">

                            </div>
                            <div id="er">

                            </div>
							</div>
                            {% endif %}
						{% endif %}
                    <script>
                        console.log("TEST");

                        {#console.log($('#id_title').val())#}

                        var frm = $('#eventform');
                        frm.submit(function () {
                            $("#suc").html("");
                            $("#er").html("");
                            $.ajax({
                                type: frm.attr('method'),
                                url: frm.attr('action'),
                                data: frm.serialize(),
                                success: function (data) {
                                    $('#eventform').fadeOut(400);
                                    setTimeout(
                                      function()
                                      {
                                        $("#suc").addClass("success");
                                        $("#suc").html("Succesfully created");
                                      }, 440);

                                    $('#eventform')[0].reset();
                                    console.log("SUCCESSSSSSSSSSSSS");
                                    console.log(data)
                                },
                                error: function(data) {
                                    $("#er").html("Something went wrong!");
                                    $('#eventform')[0].reset();
                                    console.log("FAIL");
                                }
                            });
                            return false;
                        });
                    </script>
					</div>
				</div>
				</div>
			</div>

		</div>
		<!-- /Home -->
{% endblock %}